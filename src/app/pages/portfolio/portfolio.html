<div class="portfolio-container" [class.secure-mode]="secureMode()">
  <!-- Header with back button and mode indicator -->
  <header class="portfolio-header">
    <div class="header-content">
      <a routerLink="/" class="btn-back">‚Üê Back to Home</a>
      <div class="mode-indicator" *ngIf="secureMode()">
        <span class="badge secure">üîê Admin Mode</span>
        <button class="btn-save-page" (click)="savePage()">üíæ Save Page</button>
        <button class="btn-logout" (click)="logout()">Logout</button>
      </div>
      <div class="mode-indicator" *ngIf="!secureMode()">
        <span class="badge public">üîì Public View</span>
      </div>
    </div>
  </header>

  <!-- Profile Section -->
  <section class="profile-section" *ngIf="profile()">
    <div class="section-header">
      <h1>{{ profile()!.name }}</h1>
      <button 
        *ngIf="secureMode() && !editingProfile()" 
        class="btn-edit"
        (click)="startEditProfile()">
        ‚úèÔ∏è Edit Profile
      </button>
    </div>

    <!-- Profile View Mode -->
    <div *ngIf="!editingProfile()" class="profile-content">
      <div class="profile-main">
        <div class="profile-avatar" *ngIf="profile()!.avatar">
          <img [src]="profile()!.avatar" [alt]="profile()!.name">
        </div>
        <div class="profile-info">
          <h2 class="profile-title">{{ profile()!.title }}</h2>
          <p class="profile-bio">{{ profile()!.bio }}</p>
          <div class="profile-details">
            <p *ngIf="profile()!.email">üìß {{ profile()!.email }}</p>
            <p *ngIf="profile()!.phone">üìû {{ profile()!.phone }}</p>
            <p *ngIf="profile()!.location">üìç {{ profile()!.location }}</p>
          </div>
          <div class="social-links" *ngIf="profile()!.socialLinks">
            <a *ngIf="profile()!.socialLinks!.github" [href]="profile()!.socialLinks!.github" target="_blank" class="social-link">GitHub</a>
            <a *ngIf="profile()!.socialLinks!.linkedin" [href]="profile()!.socialLinks!.linkedin" target="_blank" class="social-link">LinkedIn</a>
            <a *ngIf="profile()!.socialLinks!.twitter" [href]="profile()!.socialLinks!.twitter" target="_blank" class="social-link">Twitter</a>
            <a *ngIf="profile()!.socialLinks!.website" [href]="profile()!.socialLinks!.website" target="_blank" class="social-link">Website</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Edit Mode -->
    <div *ngIf="editingProfile() && secureMode()" class="edit-form">
      <h3>Edit Profile</h3>
      <div class="form-group">
        <label>Name</label>
        <input type="text" [(ngModel)]="profileForm.name" />
      </div>
      <div class="form-group">
        <label>Title</label>
        <input type="text" [(ngModel)]="profileForm.title" />
      </div>
      <div class="form-group">
        <label>Bio</label>
        <textarea [(ngModel)]="profileForm.bio" rows="4"></textarea>
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" [(ngModel)]="profileForm.email" />
      </div>
      <div class="form-group">
        <label>Phone</label>
        <input type="text" [(ngModel)]="profileForm.phone" />
      </div>
      <div class="form-group">
        <label>Location</label>
        <input type="text" [(ngModel)]="profileForm.location" />
      </div>
      <div class="form-actions">
        <button class="btn-save" (click)="saveProfile()">Save</button>
        <button class="btn-cancel" (click)="cancelEditProfile()">Cancel</button>
      </div>
    </div>
  </section>

  <!-- Skills Section -->
  <section class="skills-section">
    <div class="section-header">
      <h2>Skills</h2>
      <button 
        *ngIf="secureMode() && editingSkill() !== 'new'" 
        class="btn-add"
        (click)="startAddSkill()">
        ‚ûï Add Skill
      </button>
    </div>

    <!-- Add/Edit Skill Form -->
    <div *ngIf="editingSkill() && secureMode()" class="edit-form">
      <h3>{{ editingSkill() === 'new' ? 'Add' : 'Edit' }} Skill</h3>
      <div class="form-group">
        <label>Name</label>
        <input type="text" [(ngModel)]="skillForm.name" />
      </div>
      <div class="form-group">
        <label>Category</label>
        <select [(ngModel)]="skillForm.category">
          <option value="frontend">Frontend</option>
          <option value="backend">Backend</option>
          <option value="database">Database</option>
          <option value="devops">DevOps</option>
          <option value="other">Other</option>
        </select>
      </div>
      <div class="form-group">
        <label>Proficiency: {{ skillForm.proficiency || 50 }}%</label>
        <input type="range" min="0" max="100" [(ngModel)]="skillForm.proficiency" />
      </div>
      <div class="form-actions">
        <button class="btn-save" (click)="saveSkill()">Save</button>
        <button class="btn-cancel" (click)="cancelEditSkill()">Cancel</button>
      </div>
    </div>

    <!-- Skills Display -->
    <div class="skills-grid">
      <div *ngFor="let category of skillCategories" class="skill-category">
        <h3 *ngIf="getSkillsByCategory(category).length > 0">{{ category | titlecase }}</h3>
        <div class="skills-list">
          <div *ngFor="let skill of getSkillsByCategory(category)" class="skill-item">
            <div class="skill-info">
              <span class="skill-name">{{ skill.name }}</span>
              <div class="skill-bar">
                <div class="skill-progress" [style.width.%]="skill.proficiency"></div>
              </div>
              <span class="skill-percentage">{{ skill.proficiency }}%</span>
            </div>
            <div *ngIf="secureMode()" class="skill-actions">
              <button 
                *ngIf="editingSkill() !== skill.id" 
                class="btn-icon"
                (click)="startEditSkill(skill)">
                ‚úèÔ∏è
              </button>
              <button 
                *ngIf="editingSkill() !== skill.id" 
                class="btn-icon btn-delete"
                (click)="deleteSkill(skill.id)">
                üóëÔ∏è
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Projects Section -->
  <section class="projects-section">
    <div class="section-header">
      <h2>Projects</h2>
      <button 
        *ngIf="secureMode() && editingProject() !== 'new'" 
        class="btn-add"
        (click)="startAddProject()">
        ‚ûï Add Project
      </button>
    </div>

    <!-- Add/Edit Project Form -->
    <div *ngIf="editingProject() && secureMode()" class="edit-form">
      <h3>{{ editingProject() === 'new' ? 'Add' : 'Edit' }} Project</h3>
      <div class="form-group">
        <label>Title</label>
        <input type="text" [(ngModel)]="projectForm.title" />
      </div>
      <div class="form-group">
        <label>Description</label>
        <textarea [(ngModel)]="projectForm.description" rows="4"></textarea>
      </div>
      <div class="form-group">
        <label>Technologies</label>
        <div class="tech-tags">
          <span *ngFor="let tech of projectForm.technologies; let i = index" class="tech-tag">
            {{ tech }}
            <button *ngIf="secureMode()" (click)="removeTechnology(i)" class="tag-remove">√ó</button>
          </span>
        </div>
        <button *ngIf="secureMode()" class="btn-add-tech" (click)="addTechnology()">+ Add Technology</button>
      </div>
      <div class="form-group">
        <label>GitHub URL</label>
        <input type="url" [(ngModel)]="projectForm.githubUrl" />
      </div>
      <div class="form-group">
        <label>Live URL</label>
        <input type="url" [(ngModel)]="projectForm.liveUrl" />
      </div>
      <div class="form-group">
        <label>
          <input type="checkbox" [(ngModel)]="projectForm.featured" />
          Featured Project
        </label>
      </div>
      <div class="form-actions">
        <button class="btn-save" (click)="saveProject()">Save</button>
        <button class="btn-cancel" (click)="cancelEditProject()">Cancel</button>
      </div>
    </div>

    <!-- Projects Grid -->
    <div class="projects-grid">
      <div *ngFor="let project of projects()" class="project-card">
        <div class="project-header">
          <h3>{{ project.title }}</h3>
          <span *ngIf="project.featured" class="featured-badge">‚≠ê Featured</span>
        </div>
        <p class="project-description">{{ project.description }}</p>
        <div class="project-technologies">
          <span *ngFor="let tech of project.technologies" class="tech-badge">{{ tech }}</span>
        </div>
        <div class="project-links">
          <a *ngIf="project.githubUrl" [href]="project.githubUrl" target="_blank" class="project-link">GitHub</a>
          <a *ngIf="project.liveUrl" [href]="project.liveUrl" target="_blank" class="project-link">Live Demo</a>
        </div>
        <div *ngIf="secureMode()" class="project-actions">
          <button class="btn-edit" (click)="startEditProject(project)">‚úèÔ∏è Edit</button>
          <button class="btn-delete" (click)="deleteProject(project.id)">üóëÔ∏è Delete</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Custom Sections -->
  <section class="custom-sections" *ngIf="sections().length || secureMode()">
    <div class="section-header">
      <h2>Additional Sections</h2>
      <button
        *ngIf="secureMode() && editingSection() !== 'new'"
        class="btn-add"
        (click)="startAddSection()">
        ‚ûï Add Section
      </button>
    </div>

    <!-- Add/Edit Section Form -->
    <div *ngIf="editingSection() && secureMode()" class="edit-form">
      <h3>{{ editingSection() === 'new' ? 'Add' : 'Edit' }} Section</h3>
      <div class="form-group">
        <label>Title</label>
        <input type="text" [(ngModel)]="sectionForm.title" />
      </div>
      <div class="form-group">
        <label>Subtitle</label>
        <input type="text" [(ngModel)]="sectionForm.subtitle" />
      </div>
      <div class="form-group">
        <label>Content</label>
        <textarea [(ngModel)]="sectionForm.content" rows="4"></textarea>
      </div>
      <div class="form-actions">
        <button class="btn-save" (click)="saveSection()">Save</button>
        <button class="btn-cancel" (click)="cancelEditSection()">Cancel</button>
      </div>
    </div>

    <div class="custom-sections-grid">
      <div
        *ngFor="let section of sections()"
        class="custom-section-card"
        [attr.draggable]="secureMode() ? true : null"
        (dragstart)="onDragStart(section.id)"
        (dragend)="onDragEnd()"
        (dragover)="onDragOver($event, section.id)"
        (drop)="onDrop($event, section.id)"
      >
        <div class="custom-section-header">
          <h3>{{ section.title }}</h3>
          <p *ngIf="section.subtitle" class="custom-section-subtitle">{{ section.subtitle }}</p>
        </div>
        <p class="custom-section-content">{{ section.content }}</p>

        <div *ngIf="secureMode()" class="custom-section-actions">
          <button class="btn-edit" (click)="startEditSection(section)">‚úèÔ∏è Edit</button>
          <button class="btn-delete" (click)="deleteSection(section.id)">üóëÔ∏è Delete</button>
        </div>
      </div>
    </div>
  </section>
</div>
